{"version":3,"sources":["./src/app/pages/item-defect/item-defect-routing.module.ts","./src/app/pages/item-defect/item-defect.module.ts","./src/app/pages/item-defect/item-defect.page.ts","./src/app/pages/item-defect/item-defect.page.scss","./src/app/pages/item-defect/item-defect.page.html"],"names":[],"mappings":"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","file":"src_app_pages_item-defect_item-defect_module_ts.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { ItemDefectPage } from './item-defect.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: ItemDefectPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class ItemDefectPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport {FormsModule, ReactiveFormsModule} from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { ItemDefectPageRoutingModule } from './item-defect-routing.module';\r\n\r\nimport { ItemDefectPage } from './item-defect.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    ItemDefectPageRoutingModule,\r\n    ReactiveFormsModule\r\n\r\n  ],\r\n  declarations: [ItemDefectPage]\r\n})\r\nexport class ItemDefectPageModule {}\r\n","import {Component, OnDestroy, OnInit} from '@angular/core';\r\nimport {ActivatedRoute, Router} from \"@angular/router\";\r\nimport {ActionSheetController, ToastController} from \"@ionic/angular\";\r\nimport {CommonStateService} from \"../../services/common-state.service\";\r\nimport {Subscription} from \"rxjs\";\r\nimport {mergeMap} from \"rxjs/operators\";\r\nimport {Item} from \"../../services/model\";\r\nimport {ItemResourceService} from \"../../services/api-services/item-resource.service\";\r\nimport {ItemCasualityResourceService} from \"../../services/api-services/casuality.service\";\r\nimport {FormControl, FormGroup, Validators} from \"@angular/forms\";\r\n\r\n@Component({\r\n  selector: 'app-item-update',\r\n  templateUrl: './item-defect.page.html',\r\n  styleUrls: ['./item-defect.page.scss'],\r\n})\r\nexport class ItemDefectPage implements OnInit, OnDestroy {\r\n  private subscriptions: Subscription[] = [];\r\n\r\n  /** @internal */\r\n  showMobileMenu = true;\r\n\r\n  /** @internal  */\r\n  item: Item;\r\n  casualityForm =   new FormGroup({\r\n    description: new FormControl('', Validators.required)\r\n  })\r\n\r\n\r\n\r\n  constructor(public router: Router,\r\n              public state: CommonStateService,\r\n              private actionSheetController: ActionSheetController,\r\n              private activeRoute: ActivatedRoute,\r\n              private itemService: ItemResourceService,\r\n              private toastController: ToastController,\r\n              private casualityService: ItemCasualityResourceService\r\n  ) {\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.subscriptions.push(\r\n      this.state.getSplitPaneVisible().subscribe(\r\n        (isVisible) => this.showMobileMenu = !isVisible\r\n      )\r\n    )\r\n    this.activeRoute.queryParams.pipe(\r\n      mergeMap(params => {\r\n        return this.itemService.getItemByCode(params.itemId)\r\n      })\r\n    ).subscribe(async (item) => {\r\n      if (!item || item === 'NOT_FOUND') {\r\n        this.presentToast('Es wurde keine Gerät mit diesem Code gefunden',\r\n          'danger', 2000, \"bottom\");\r\n        await this.router.navigate(['/tabs/dashboard']);\r\n        return\r\n      }\r\n      this.item = item as Item;\r\n      if(this.item.borrowed === true && this.item.status === 'aktiv') {\r\n        this.presentToast('Achtung - Gerät ist aktuell ausgeborgt!',\r\n          'warning', 4000, \"middle\");\r\n      }\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.subscriptions.forEach(s => s.unsubscribe());\r\n  };\r\n\r\n  backButtonClicked() {\r\n    this.router.navigate(['equipment'], {\r\n      queryParams: {id: this.item.dynamic_id}\r\n    });\r\n  }\r\n\r\n  decommissionAndReturn() {\r\n    this.postCasuality('dekommisioniert')\r\n  }\r\n\r\n  toggleActivateAndReturn() {\r\n    this.postCasuality(this.item.status === 'aktiv' ? 'inaktiv' : 'aktiv')\r\n  }\r\n\r\n  postCasuality(status: 'aktiv' | 'inaktiv' | 'dekommisioniert'){\r\n    this.casualityForm.get('description').markAllAsTouched()\r\n    const desc = this.casualityForm.get('description').value\r\n    if(!desc) {return}\r\n    this.casualityService.post({\r\n      item_id: this.item.dynamic_id,\r\n      status,\r\n      description: desc,\r\n    },{}).subscribe(result => {\r\n      if(result) {\r\n        this.presentToast(\r\n          (status === 'aktiv' ? \"Gerät aktiviert\" : status === 'inaktiv' ? \"Defekt gemeldet\" : \"Gerät dekommissioniert\")\r\n          , \"success\", 1000, 'middle')\r\n        this.backButtonClicked();\r\n        this.casualityForm.reset()\r\n      } else {\r\n        this.presentToast(\"Fehler beim anlegen des Defekts\", \"danger\", 2000, 'middle')\r\n      }\r\n    })\r\n\r\n  }\r\n\r\n  async presentToast(message: string, color: string, duration: number, position: any) {\r\n    const p = await this.toastController.create({message, color, duration, position})\r\n    await p.present();\r\n  }\r\n\r\n}\r\n","export default \".item-defect-wrapper {\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: space-between;\\n  height: 100%;\\n  padding-bottom: 1rem;\\n}\\n\\n.item-update-flex-main {\\n  display: flex;\\n  flex-direction: column;\\n}\\n\\n.item-update-flex-item-infos {\\n  display: flex;\\n  flex-direction: column;\\n}\\n\\n.item-update-textarea {\\n  border: solid #f6f7f9 2px;\\n  border-radius: 6px;\\n}\\n\\n.item-textarea {\\n  border: solid #f6f7f9 1px;\\n  border-radius: 6px;\\n}\\n\\n.page-io-bottom-toolbar {\\n  justify-content: center;\\n  display: flex;\\n  padding-right: 2rem;\\n  padding-left: 2rem;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIml0ZW0tZGVmZWN0LnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQUE7RUFDQSxzQkFBQTtFQUNBLDhCQUFBO0VBQ0EsWUFBQTtFQUNBLG9CQUFBO0FBQ0Y7O0FBRUE7RUFDRSxhQUFBO0VBQ0Esc0JBQUE7QUFDRjs7QUFFQTtFQUNFLGFBQUE7RUFDQSxzQkFBQTtBQUNGOztBQUVBO0VBQ0UseUJBQUE7RUFDQSxrQkFBQTtBQUNGOztBQUVBO0VBQ0UseUJBQUE7RUFDQSxrQkFBQTtBQUNGOztBQUVBO0VBQ0UsdUJBQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSxrQkFBQTtBQUNGIiwiZmlsZSI6Iml0ZW0tZGVmZWN0LnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5pdGVtLWRlZmVjdC13cmFwcGVye1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XHJcbiAgaGVpZ2h0OiAxMDAlO1xyXG4gIHBhZGRpbmctYm90dG9tOiAxcmVtO1xyXG59XHJcblxyXG4uaXRlbS11cGRhdGUtZmxleC1tYWluIHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbn1cclxuXHJcbi5pdGVtLXVwZGF0ZS1mbGV4LWl0ZW0taW5mb3Mge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxufVxyXG5cclxuLml0ZW0tdXBkYXRlLXRleHRhcmVhIHtcclxuICBib3JkZXI6IHNvbGlkICNmNmY3ZjkgMnB4O1xyXG4gIGJvcmRlci1yYWRpdXM6IDZweDtcclxufVxyXG5cclxuLml0ZW0tdGV4dGFyZWEge1xyXG4gIGJvcmRlcjogc29saWQgI2Y2ZjdmOSAxcHg7XHJcbiAgYm9yZGVyLXJhZGl1czogNnB4O1xyXG59XHJcblxyXG4ucGFnZS1pby1ib3R0b20tdG9vbGJhciB7XHJcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBwYWRkaW5nLXJpZ2h0OiAycmVtO1xyXG4gIHBhZGRpbmctbGVmdDogMnJlbTtcclxufVxyXG4iXX0= */\";","export default \"<ion-header>\\r\\n  <ion-toolbar>\\r\\n    <ion-buttons\\r\\n      *ngIf=\\\"this.showMobileMenu\\\"\\r\\n      slot=\\\"start\\\" class=\\\"back-button\\\" (click)=\\\"backButtonClicked()\\\">\\r\\n      <ion-icon slot=\\\"icon-only\\\" name=\\\"arrow-back-outline\\\"></ion-icon>\\r\\n    </ion-buttons>\\r\\n    <ion-title>Equipment: {{this.item?.model_name}} / {{this.item?.status}}</ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n  <div class=\\\"item-defect-wrapper\\\">\\r\\n\\r\\n  <div class=\\\"item-defect-flex-main ion-margin ion-padding\\\">\\r\\n    <div class=\\\"item-defect-flex-item-infos\\\">\\r\\n      <p>Item Name: {{this.item?.model_name}}</p>\\r\\n      <p>Item Beschreibung: {{this.item?.description}}</p>\\r\\n    </div>\\r\\n    <form [formGroup]=\\\"this.casualityForm\\\" class=\\\"item-defect-textarea\\\">\\r\\n      <ion-item>\\r\\n        <ion-input\\r\\n                   formControlName=\\\"description\\\"\\r\\n                   placeholder=\\\"{{'Begründung'}}\\\"\\r\\n        ></ion-input>\\r\\n      </ion-item>\\r\\n\\r\\n    </form>\\r\\n\\r\\n  </div>\\r\\n  <div class=\\\"page-io-bottom-toolbar\\\" [ngClass]=\\\"{ 'ion-justify-content-between': !showMobileMenu }\\\">\\r\\n    <div *ngIf=\\\"!showMobileMenu\\\">\\r\\n      <ion-button class=\\\"max-width-100\\\" color=\\\"primary\\\" [fill]=\\\"'outline'\\\"\\r\\n                  (click)=\\\"backButtonClicked()\\\">\\r\\n        Zurück\\r\\n      </ion-button>\\r\\n    </div>\\r\\n    <ion-button class=\\\"max-width-100\\\" color=\\\"danger\\\" [fill]=\\\"'outline'\\\"\\r\\n                [disabled]=\\\"this.item?.status === 'dekommisioniert'\\\"\\r\\n                (click)=\\\"decommissionAndReturn()\\\">\\r\\n      Dekommissionieren\\r\\n    </ion-button>\\r\\n    <ion-button class=\\\"max-width-100\\\" [color]=\\\"this.item?.status === 'aktiv' ? 'danger' : 'success'\\\"\\r\\n                [disabled]=\\\"this.item?.status === 'dekommisioniert'\\\"\\r\\n                (click)=\\\"toggleActivateAndReturn()\\\">\\r\\n      {{this.item?.status === 'aktiv' ? 'Defekt melden' : 'aktivieren'}}\\r\\n    </ion-button>\\r\\n  </div>\\r\\n  </div>\\r\\n</ion-content>\\r\\n\";"],"sourceRoot":"webpack:///"}